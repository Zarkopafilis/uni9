MICRO

c Bootstrap
m00 00000 000 000 111 000 011 1000 1000 00 0111010111
m01 00000 000 000 000 000 001 0000 0000 00 0010000000

c LDA $K, X - as of ex2
m02 00000 000 000 101 000 011 1000 1000 01 0111011110 // K at MDR on next clock
m03 00000 000 000 101 000 001 1010 1010 00 0111011101 // MDR + B (X) -> MAR 
m04 00000 000 000 111 000 011 1001 1001 00 0110011101 // val -> Accumulator
c NEXTINSTR
m05 00000 000 000 101 000 011 1000 1000 01 0111011110
m06 00000 000 000 000 000 001 0000 0000 00 0010000000

c LDX #K - as of exc2
m07 00000 000 000 101 000 011 1000 1000 01 0111011110 // K at MDR on next clock
m08 00000 000 000 111 000 011 1010 1010 00 0110011101 // K -> B (X - Helper register)
c NEXTINSTR
m09 00000 000 000 101 000 011 1000 1000 01 0111011110
m0a 00000 000 000 000 000 001 0000 0000 00 0010000000

c STA $K, X
m0b 00000 000 000 101 000 011 1000 1000 01 0111011110 //K at MDR
m0c 00000 000 000 101 000 011 1010 1010 00 0101011101 //MDR + B -> NOP, MAR 
m0d 00000 000 000 100 000 001 0000 0000 00 0100011111 //ACC + 0 -> NOP, MWE~
c NEXTINSTR
m0e 00000 000 000 101 000 011 1000 1000 01 0111011110
m0f 00000 000 000 000 000 001 0000 0000 00 0010000000

c INX
m10 00000 000 000 101 000 011 1010 1010 01 0110111110
c NEXTINSTR
m11 00000 000 000 101 000 011 1000 1000 01 0111011110
m12 00000 000 000 000 000 001 0000 0000 00 0010000000

c CMPX #Y
m13 00000 000 000 101 000 011 1000 1000 01 0111011110 // K at MDR on next clock
m14 00000 000 000 101 001 011 1010 1010 00 0110111011
c NEXTINSTR
m15 00000 000 000 101 000 011 1000 1000 01 0111011110
m16 00000 000 000 000 000 001 0000 0000 00 0010000000

c ADC $K, Y
m17 00000 000 000 101 000 011 1000 1000 01 0111011110 // $K at MDR 
m18 00000 000 000 101 000 011 1010 1010 00 0011011101 //MDR + B -> NOP, MAR  
m19 00000 000 000 101 000 011 1001 1001 00 0010111011
c NEXTINSTR
m1a 00000 000 000 101 000 011 1000 1000 01 0111011110
m1b 00000 000 000 000 000 001 0000 0000 00 0010000000

c CRC 
m1c 00000 000 000 111 001 011 0000 0000 00 0110111011
c NEXTINSTR
m1d 00000 000 000 101 000 011 1000 1000 01 0111011110
m1e 00000 000 000 000 000 001 0000 0000 00 0010000000

c SHLA 
m1f 00000 000 000 100 000 110 1001 1010 00 0010011111
c NEXTINSTR
m20 00000 000 000 101 000 011 1000 1000 01 0111011110
m21 00000 000 000 000 000 001 0000 0000 00 0010000000

c HALT 
m22 00000 010 000 000 000 000 0000 0000 00 0111011110


c BRNZ $K
m23 00000 000 000 101 000 011 1000 1000 01 0111011110 // $K at MDR 
m24 00011 011 011 000 000 000 0000 0000 00 0110011110
c NEXTINSTR
m25 00000 000 000 101 000 011 1000 1000 01 0111011110
m26 00000 000 000 000 000 001 0000 0000 00 0010000000
c CHANGE PC
m27 00000 000 000 111 000 011 1000 1000 00 0111011110
m28 00000 000 000 000 000 001 0000 0000 00 0010000000

MAPPER

c LDA $K, X 
m00 02
c LDX #K
m01 07
c INX 
m02 10
c CMPX #Y
m03 13
c STA $K, X 
m04 0b

c ADC $K, X 
m05 17
c CRC 
m06 1c
c BRNZ $K
m07 23
c SHLA 
m08 1f
c HALT
m09 22

MAIN

c CRC
m00 06
c LDX #0
m01 01
m02 00
c LDA $Z, X 
m03 00
m04 1f
c SHLA
m05 08
c ADC $Y, X 
m06 05
m07 18
c STA $W, X  
m08 04 
m09 10 
c INX 
m0a 02
c CMPX #7
m0b 03
m0c 07
c BRNZ $01 // after CRC 
m0d 07
m0e 01
c HALT
m0f 09

c -- Data Region --
c W[0:7]
m10 00
m11 00
m12 00
m14 00
m15 00
m16 00
m17 00

c Y[0:7]
m18 04
m19 05
m1a 06
m1b 07
m1c 08
m1d 09
m1e 0a

c Z[0:7]
m1f 06
m20 07
m21 08
m22 09
m23 0a
m24 0b
m25 0c
